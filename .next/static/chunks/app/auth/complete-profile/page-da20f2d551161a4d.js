(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[740],{2817:function(e,t,a){Promise.resolve().then(a.bind(a,79))},79:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var r=a(7437),n=a(605),s=a(9376),o=a(2265),l=a(2369),i=a(9345),c=a(9763);let d=(0,c.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var m=a(3774),u=a(1047),x=a(3229);let h=(0,c.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var p=a(9178),f=a(4226),g=a(3214),v=a(4438);function b(){let{data:e,status:t,update:a}=(0,n.useSession)(),c=(0,s.useRouter)(),[b,j]=(0,o.useState)({}),[y,N]=(0,o.useState)(!1),[w,D]=(0,o.useState)(!1),[C,k]=(0,o.useState)({}),[E,R]=(0,o.useState)(!1),P=(0,o.useRef)(null);(0,o.useEffect)(()=>{if("loading"!==t){if(!e){(0,n.signIn)();return}if(e.user.profileComplete){let t=e.user.role;"ADMIN"===t||"SUPERVISOR"===t?c.push("/admin"):c.push("/employee")}}},[e,t,c]),(0,o.useEffect)(()=>{console.log("\uD83D\uDD04 Componente hidratado, anexando event listeners..."),R(!0);let e=P.current;if(e){console.log("\uD83D\uDCCB Anexando event listener manual ao formul\xe1rio");let t=async e=>{console.log("\uD83D\uDE80 Event listener manual chamado!"),e.preventDefault(),await Z(e)};return e.addEventListener("submit",t),console.log("✅ Event listener manual anexado"),()=>{console.log("\uD83E\uDDF9 Removendo event listener manual"),e.removeEventListener("submit",t)}}console.log("❌ Formul\xe1rio n\xe3o encontrado para anexar listener manual")},[b]);let T=()=>{console.log("\uD83D\uDD0D Validando formul\xe1rio com dados:",b);let e={};return b.phone?/^\(\d{2}\)\s\d{4,5}-\d{4}$/.test(b.phone)||(e.phone="Formato inv\xe1lido. Use: (11) 99999-9999"):e.phone="Telefone \xe9 obrigat\xf3rio",b.address||(e.address="Endere\xe7o \xe9 obrigat\xf3rio"),b.birthDate||(e.birthDate="Data de nascimento \xe9 obrigat\xf3ria"),b.emergencyContact||(e.emergencyContact="Contato de emerg\xeancia \xe9 obrigat\xf3rio"),b.emergencyPhone?/^\(\d{2}\)\s\d{4,5}-\d{4}$/.test(b.emergencyPhone)||(e.emergencyPhone="Formato inv\xe1lido. Use: (11) 99999-9999"):e.emergencyPhone="Telefone de emerg\xeancia \xe9 obrigat\xf3rio",b.department||(e.department="Departamento \xe9 obrigat\xf3rio"),b.startDate||(e.startDate="Data de in\xedcio \xe9 obrigat\xf3ria"),Object.keys(e).length>0?console.log("❌ Erros de valida\xe7\xe3o encontrados:",e):console.log("✅ Valida\xe7\xe3o passou - todos os campos OK"),k(e),0===Object.keys(e).length},Z=async e=>{if(console.log("\uD83D\uDE80 handleSubmit chamado!"),e.preventDefault(),console.log("\uD83D\uDCDD Dados do formul\xe1rio:",b),!T()){console.log("❌ Valida\xe7\xe3o falhou");return}console.log("✅ Valida\xe7\xe3o passou");try{N(!0),k({}),console.log("Enviando dados:",b);let e=await fetch("/api/auth/complete-profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(console.log("Response status:",e.status),e.ok){let t=await e.json();console.log("Perfil salvo com sucesso:",t),v.Am.success("Perfil completado com sucesso!"),D(!0);let a=t.redirectUrl||"/employee";console.log("URL de redirecionamento:",a),t.forceReload?(console.log("For\xe7ando navega\xe7\xe3o completa para:",a),console.log("Tentativa 1: Redirecionamento imediato"),window.location.href=a,setTimeout(()=>{console.log("Tentativa 2: Redirecionamento com setTimeout 500ms"),window.location.href=a},500),setTimeout(()=>{console.log("Tentativa 3: Redirecionamento com setTimeout 1500ms"),window.location.href=a},1500),setTimeout(()=>{console.log("Tentativa 4: window.location.replace"),window.location.replace(a)},2e3)):setTimeout(()=>{console.log("For\xe7ando reload da p\xe1gina..."),window.location.reload()},1500)}else{let t=await e.json();console.error("Erro na API:",t);let a=t.message||"Erro ao salvar perfil";k({general:a}),v.Am.error(a)}}catch(t){console.error("Erro no submit:",t);let e="Erro interno. Tente novamente.";k({general:e}),v.Am.error(e)}finally{N(!1)}},O=e=>{let t=e.replace(/\D/g,"");return t.length<=10?t.replace(/(\d{2})(\d{4})(\d{4})/,"($1) $2-$3"):t.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3")},S=(e,t)=>{let a=O(t);j(t=>({...t,[e]:a}))};return"loading"===t?(0,r.jsx)(g.gb,{}):e?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-900 flex items-center justify-center p-6",children:(0,r.jsx)("div",{className:"w-full max-w-2xl",children:(0,r.jsxs)(p.Zb,{children:[(0,r.jsxs)(p.Ol,{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(l.Z,{className:"h-8 w-8 text-primary"})}),(0,r.jsx)(p.ll,{className:"text-2xl",children:"Complete seu Perfil"}),(0,r.jsxs)("p",{className:"text-neutral-400",children:["Ol\xe1, ",e.user.name,"! Para continuar, precisamos de algumas informa\xe7\xf5es adicionais."]})]}),(0,r.jsx)(p.aY,{children:(0,r.jsxs)("form",{ref:P,onSubmit:Z,className:"space-y-6",children:[C.general&&(0,r.jsx)("div",{className:"p-4 bg-error/20 border border-error/50 rounded-lg text-error text-sm",children:C.general}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Informa\xe7\xf5es Pessoais"}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Email (j\xe1 confirmado)"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(i.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400"}),(0,r.jsx)("input",{type:"email",value:e.user.email||"",disabled:!0,className:"input pl-10 bg-neutral-700"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Telefone *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400"}),(0,r.jsx)("input",{type:"tel",placeholder:"(11) 99999-9999",className:"input pl-10 ".concat(C.phone?"border-error":""),value:b.phone||"",onChange:e=>S("phone",e.target.value),maxLength:15})]}),C.phone&&(0,r.jsx)("p",{className:"text-error text-xs mt-1",children:C.phone})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Endere\xe7o Completo *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(m.Z,{className:"absolute left-3 top-3 h-4 w-4 text-neutral-400"}),(0,r.jsx)("textarea",{placeholder:"Rua, n\xfamero, bairro, cidade, CEP",className:"input pl-10 min-h-[80px] resize-none ".concat(C.address?"border-error":""),value:b.address||"",onChange:e=>j(t=>({...t,address:e.target.value}))})]}),C.address&&(0,r.jsx)("p",{className:"text-error text-xs mt-1",children:C.address})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Data de Nascimento *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400"}),(0,r.jsx)("input",{type:"date",className:"input pl-10 ".concat(C.birthDate?"border-error":""),value:b.birthDate||"",onChange:e=>j(t=>({...t,birthDate:e.target.value}))})]}),C.birthDate&&(0,r.jsx)("p",{className:"text-error text-xs mt-1",children:C.birthDate})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Contato de Emerg\xeancia"}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Nome do Contato *"}),(0,r.jsx)("input",{type:"text",placeholder:"Nome completo",className:"input ".concat(C.emergencyContact?"border-error":""),value:b.emergencyContact||"",onChange:e=>j(t=>({...t,emergencyContact:e.target.value}))}),C.emergencyContact&&(0,r.jsx)("p",{className:"text-error text-xs mt-1",children:C.emergencyContact})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Telefone de Emerg\xeancia *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400"}),(0,r.jsx)("input",{type:"tel",placeholder:"(11) 99999-9999",className:"input pl-10 ".concat(C.emergencyPhone?"border-error":""),value:b.emergencyPhone||"",onChange:e=>S("emergencyPhone",e.target.value),maxLength:15})]}),C.emergencyPhone&&(0,r.jsx)("p",{className:"text-error text-xs mt-1",children:C.emergencyPhone})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Informa\xe7\xf5es Profissionais"}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Departamento *"}),(0,r.jsxs)("select",{className:"input ".concat(C.department?"border-error":""),value:b.department||"",onChange:e=>j(t=>({...t,department:e.target.value})),children:[(0,r.jsx)("option",{value:"",children:"Selecione o departamento"}),(0,r.jsx)("option",{value:"TI",children:"Tecnologia da Informa\xe7\xe3o"}),(0,r.jsx)("option",{value:"RH",children:"Recursos Humanos"}),(0,r.jsx)("option",{value:"FINANCEIRO",children:"Financeiro"}),(0,r.jsx)("option",{value:"MARKETING",children:"Marketing"}),(0,r.jsx)("option",{value:"VENDAS",children:"Vendas"}),(0,r.jsx)("option",{value:"OPERACOES",children:"Opera\xe7\xf5es"}),(0,r.jsx)("option",{value:"JURIDICO",children:"Jur\xeddico"}),(0,r.jsx)("option",{value:"OUTROS",children:"Outros"})]}),C.department&&(0,r.jsx)("p",{className:"text-error text-xs mt-1",children:C.department})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Data de In\xedcio *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400"}),(0,r.jsx)("input",{type:"date",className:"input pl-10 ".concat(C.startDate?"border-error":""),value:b.startDate||"",onChange:e=>j(t=>({...t,startDate:e.target.value}))})]}),C.startDate&&(0,r.jsx)("p",{className:"text-error text-xs mt-1",children:C.startDate})]})]})]}),(0,r.jsx)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-neutral-700",children:(0,r.jsx)(f.z,{type:"submit",disabled:y||w,className:"min-w-[150px]",children:w?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Redirecionando..."})]}):y?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Salvando..."})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Salvar e Continuar"}),(0,r.jsx)(h,{className:"h-4 w-4"})]})})})]})})]})})}):null}},4226:function(e,t,a){"use strict";a.d(t,{z:function(){return o}});var r=a(7437),n=a(2265),s=a(4508);let o=n.forwardRef((e,t)=>{let{className:a,variant:o="primary",size:l="md",loading:i=!1,asChild:c=!1,children:d,disabled:m,...u}=e,x=(0,s.cn)("btn",{primary:"btn-primary",secondary:"btn-secondary",ghost:"btn-ghost",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90"}[o],{sm:"btn-sm",md:"btn-md",lg:"btn-lg"}[l],i&&"opacity-50 cursor-not-allowed",a);if(c){var h;return n.cloneElement(d,{className:(0,s.cn)(x,null===(h=d.props)||void 0===h?void 0:h.className),...u})}return(0,r.jsxs)("button",{className:x,ref:t,disabled:m||i,...u,children:[i&&(0,r.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),d]})});o.displayName="Button"},9178:function(e,t,a){"use strict";a.d(t,{Ol:function(){return l},Zb:function(){return o},aY:function(){return c},ll:function(){return i}});var r=a(7437),n=a(2265),s=a(4508);let o=n.forwardRef((e,t)=>{let{className:a,variant:n="default",children:o,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)({default:"card",glass:"card glass",elevated:"card shadow-xl hover:shadow-2xl transition-shadow duration-300"}[n],a),...l,children:o})});o.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",a),...n})});l.displayName="CardHeader";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("h3",{ref:t,className:(0,s.cn)("font-semibold leading-none tracking-tight",a),...n})});i.displayName="CardTitle",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",a),...n})}).displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",a),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",a),...n})}).displayName="CardFooter"},3214:function(e,t,a){"use strict";a.d(t,{gb:function(){return s}});var r=a(7437);a(2265);var n=a(4508);function s(e){let{size:t="md",className:a,text:s}=e;return(0,r.jsxs)("div",{className:(0,n.cn)("flex flex-col items-center justify-center space-y-2",a),children:[(0,r.jsx)("div",{className:(0,n.cn)("animate-spin rounded-full border-2 border-primary border-t-transparent",{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t])}),s&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground animate-pulse",children:s})]})}},4508:function(e,t,a){"use strict";a.d(t,{cn:function(){return s}});var r=a(1994),n=a(3335);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,r.W)(t))}},1047:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},9345:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},3774:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},3229:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},2369:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})}},function(e){e.O(0,[554,605,438,971,117,744],function(){return e(e.s=2817)}),_N_E=e.O()}]);