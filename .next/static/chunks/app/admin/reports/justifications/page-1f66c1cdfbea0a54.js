(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[287],{4886:function(e,s,t){Promise.resolve().then(t.bind(t,1674))},1674:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y}});var a=t(7437),r=t(605),n=t(9376),l=t(2265),i=t(7648),c=t(2660),d=t(3247),u=t(3639),x=t(1723),o=t(9763);let m=(0,o.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var h=t(2489),f=t(2369),p=t(1047);let j=(0,o.Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var N=t(9178),v=t(4226),b=t(3214);function y(){let{data:e,status:s}=(0,r.useSession)(),t=(0,n.useRouter)(),[o,y]=(0,l.useState)([]),[g,w]=(0,l.useState)(!0),[k,E]=(0,l.useState)(""),[R,Z]=(0,l.useState)("ALL"),[C,A]=(0,l.useState)("ALL"),[L,D]=(0,l.useState)(null),[P,S]=(0,l.useState)(""),[T,z]=(0,l.useState)(!1);(0,l.useEffect)(()=>{"loading"===s||e||(0,r.signIn)()},[s]),(0,l.useEffect)(()=>{var s;e&&!["ADMIN","SUPERVISOR"].includes(null===(s=e.user)||void 0===s?void 0:s.role)&&t.push("/employee")},[e]),(0,l.useEffect)(()=>{var s;e&&["ADMIN","SUPERVISOR"].includes(null===(s=e.user)||void 0===s?void 0:s.role)&&O()},[e]);let O=async()=>{try{w(!0);let e=await fetch("/api/admin/justifications");if(e.ok){let s=await e.json();y(s)}}catch(e){}finally{w(!1)}},I=async(e,s)=>{try{z(!0),(await fetch("/api/admin/justifications/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s,adminResponse:P.trim()||void 0})})).ok&&(O(),D(null),S(""))}catch(e){}finally{z(!1)}},M=o.filter(e=>{let s=e.user.name.toLowerCase().includes(k.toLowerCase())||e.user.email.toLowerCase().includes(k.toLowerCase())||e.reason.toLowerCase().includes(k.toLowerCase()),t="ALL"===R||e.status===R,a="ALL"===C||e.type===C;return s&&t&&a}),J=e=>{switch(e){case"PENDING":return"text-warning bg-warning/20";case"APPROVED":return"text-success bg-success/20";case"REJECTED":return"text-error bg-error/20";default:return"text-neutral-400 bg-neutral-400/20"}},V=e=>{switch(e){case"PENDING":return"Pendente";case"APPROVED":return"Aprovada";case"REJECTED":return"Rejeitada";default:return e}},Y=e=>"LATE"===e?"Atraso":"Falta",B=e=>"LATE"===e?"text-warning bg-warning/20":"text-error bg-error/20";return"loading"===s||g?(0,a.jsx)(b.gb,{}):e?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-900",children:[(0,a.jsx)("div",{className:"bg-neutral-800/50 border-b border-neutral-700",children:(0,a.jsx)("div",{className:"container mx-auto px-6 py-4",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(v.z,{asChild:!0,variant:"ghost",size:"sm",children:(0,a.jsxs)(i.default,{href:"/admin/reports",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Voltar aos Relat\xf3rios"]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Justificativas"}),(0,a.jsx)("p",{className:"text-neutral-400",children:"Gerenciar justificativas de atrasos e faltas"})]})]})})})}),(0,a.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,a.jsx)(N.Zb,{className:"mb-6",children:(0,a.jsx)(N.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Buscar"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Nome, email ou justificativa...",className:"input pl-10",value:k,onChange:e=>E(e.target.value)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Status"}),(0,a.jsxs)("select",{className:"input",value:R,onChange:e=>Z(e.target.value),children:[(0,a.jsx)("option",{value:"ALL",children:"Todos"}),(0,a.jsx)("option",{value:"PENDING",children:"Pendente"}),(0,a.jsx)("option",{value:"APPROVED",children:"Aprovada"}),(0,a.jsx)("option",{value:"REJECTED",children:"Rejeitada"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Tipo"}),(0,a.jsxs)("select",{className:"input",value:C,onChange:e=>A(e.target.value),children:[(0,a.jsx)("option",{value:"ALL",children:"Todos"}),(0,a.jsx)("option",{value:"LATE",children:"Atraso"}),(0,a.jsx)("option",{value:"ABSENCE",children:"Falta"})]})]})]})})}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[(0,a.jsx)(N.Zb,{children:(0,a.jsx)(N.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-neutral-400",children:"Total"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-white",children:M.length})]}),(0,a.jsx)(u.Z,{className:"h-8 w-8 text-primary"})]})})}),(0,a.jsx)(N.Zb,{children:(0,a.jsx)(N.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-neutral-400",children:"Pendentes"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-warning",children:M.filter(e=>"PENDING"===e.status).length})]}),(0,a.jsx)(x.Z,{className:"h-8 w-8 text-warning"})]})})}),(0,a.jsx)(N.Zb,{children:(0,a.jsx)(N.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-neutral-400",children:"Aprovadas"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-success",children:M.filter(e=>"APPROVED"===e.status).length})]}),(0,a.jsx)(m,{className:"h-8 w-8 text-success"})]})})}),(0,a.jsx)(N.Zb,{children:(0,a.jsx)(N.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-neutral-400",children:"Rejeitadas"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-error",children:M.filter(e=>"REJECTED"===e.status).length})]}),(0,a.jsx)(h.Z,{className:"h-8 w-8 text-error"})]})})})]}),(0,a.jsx)("div",{className:"space-y-4",children:M.map(e=>(0,a.jsx)(N.Zb,{children:(0,a.jsx)(N.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 text-neutral-400"}),(0,a.jsx)("span",{className:"font-medium text-white",children:e.user.name}),(0,a.jsxs)("span",{className:"text-neutral-400 text-sm",children:["(",e.user.email,")"]})]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(B(e.type)),children:Y(e.type)}),(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(J(e.status)),children:V(e.status)})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mb-3 text-sm text-neutral-400",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Data: ",new Date(e.date).toLocaleDateString("pt-BR")]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Enviado: ",new Date(e.createdAt).toLocaleDateString("pt-BR")]})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-300 mb-1",children:"Justificativa:"}),(0,a.jsx)("p",{className:"text-white",children:e.reason})]}),e.adminResponse&&(0,a.jsxs)("div",{className:"bg-neutral-800/50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-300 mb-1",children:"Resposta do Admin:"}),(0,a.jsx)("p",{className:"text-white text-sm",children:e.adminResponse})]})]}),"PENDING"===e.status&&(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsxs)(v.z,{size:"sm",onClick:()=>D(e),variant:"ghost",children:[(0,a.jsx)(j,{className:"h-4 w-4 mr-1"}),"Analisar"]})})]})})},e.id))}),0===M.length&&(0,a.jsx)(N.Zb,{children:(0,a.jsxs)(N.aY,{className:"p-12 text-center",children:[(0,a.jsx)(u.Z,{className:"h-12 w-12 text-neutral-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"Nenhuma justificativa encontrada"}),(0,a.jsx)("p",{className:"text-neutral-400",children:k||"ALL"!==R||"ALL"!==C?"Tente ajustar os filtros de busca":"N\xe3o h\xe1 justificativas no sistema"})]})})]}),L&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-modal flex items-center justify-center p-4",children:(0,a.jsxs)(N.Zb,{className:"w-full max-w-2xl",children:[(0,a.jsx)(N.Ol,{children:(0,a.jsx)(N.ll,{children:"Analisar Justificativa"})}),(0,a.jsxs)(N.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-neutral-800/30 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 text-neutral-400"}),(0,a.jsx)("span",{className:"font-medium text-white",children:L.user.name}),(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(B(L.type)),children:Y(L.type)})]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-400 mb-2",children:["Data: ",new Date(L.date).toLocaleDateString("pt-BR")]}),(0,a.jsx)("p",{className:"text-white",children:L.reason})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Resposta (Opcional)"}),(0,a.jsx)("textarea",{className:"input min-h-[100px] resize-none",placeholder:"Adicione uma resposta ou observa\xe7\xe3o...",value:P,onChange:e=>S(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)(v.z,{variant:"ghost",onClick:()=>{D(null),S("")},children:"Cancelar"}),(0,a.jsxs)(v.z,{variant:"destructive",onClick:()=>I(L.id,"REJECTED"),disabled:T,children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Rejeitar"]}),(0,a.jsxs)(v.z,{onClick:()=>I(L.id,"APPROVED"),disabled:T,children:[(0,a.jsx)(m,{className:"h-4 w-4 mr-2"}),"Aprovar"]})]})]})]})})]}):null}},4226:function(e,s,t){"use strict";t.d(s,{z:function(){return l}});var a=t(7437),r=t(2265),n=t(4508);let l=r.forwardRef((e,s)=>{let{className:t,variant:l="primary",size:i="md",loading:c=!1,asChild:d=!1,children:u,disabled:x,...o}=e,m=(0,n.cn)("btn",{primary:"btn-primary",secondary:"btn-secondary",ghost:"btn-ghost",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90"}[l],{sm:"btn-sm",md:"btn-md",lg:"btn-lg"}[i],c&&"opacity-50 cursor-not-allowed",t);if(d){var h;return r.cloneElement(u,{className:(0,n.cn)(m,null===(h=u.props)||void 0===h?void 0:h.className),...o})}return(0,a.jsxs)("button",{className:m,ref:s,disabled:x||c,...o,children:[c&&(0,a.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),u]})});l.displayName="Button"},9178:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},Zb:function(){return l},aY:function(){return d},ll:function(){return c}});var a=t(7437),r=t(2265),n=t(4508);let l=r.forwardRef((e,s)=>{let{className:t,variant:r="default",children:l,...i}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)({default:"card",glass:"card glass",elevated:"card shadow-xl hover:shadow-2xl transition-shadow duration-300"}[r],t),...i,children:l})});l.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})}).displayName="CardDescription";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...r})});d.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},3214:function(e,s,t){"use strict";t.d(s,{gb:function(){return n}});var a=t(7437);t(2265);var r=t(4508);function n(e){let{size:s="md",className:t,text:n}=e;return(0,a.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center justify-center space-y-2",t),children:[(0,a.jsx)("div",{className:(0,r.cn)("animate-spin rounded-full border-2 border-primary border-t-transparent",{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[s])}),n&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground animate-pulse",children:n})]})}},4508:function(e,s,t){"use strict";t.d(s,{cn:function(){return n}});var a=t(1994),r=t(3335);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,a.W)(s))}},3639:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},1723:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},3247:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2369:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2489:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[605,451,137,971,117,744],function(){return e(e.s=4886)}),_N_E=e.O()}]);