(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[582],{5628:function(e,t,s){Promise.resolve().then(s.bind(s,7948))},7948:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var r=s(7437),a=s(605),n=s(9376),l=s(2265),c=s(7648),i=s(2660),d=s(5805),x=s(6221);let u=(0,s(9763).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);var o=s(3639),m=s(1047),h=s(9178),f=s(4226),p=s(3214);function j(){let{data:e,status:t}=(0,a.useSession)(),s=(0,n.useRouter)(),[j,y]=(0,l.useState)([]),[N,v]=(0,l.useState)([]),[b,g]=(0,l.useState)(!0),[w,k]=(0,l.useState)("30"),[q,Z]=(0,l.useState)("frequency"),[C,R]=(0,l.useState)("desc");(0,l.useEffect)(()=>{"loading"===t||e||(0,a.signIn)()},[t]),(0,l.useEffect)(()=>{var t;e&&!["ADMIN","SUPERVISOR"].includes(null===(t=e.user)||void 0===t?void 0:t.role)&&s.push("/employee")},[e]),(0,l.useEffect)(()=>{var t;e&&["ADMIN","SUPERVISOR"].includes(null===(t=e.user)||void 0===t?void 0:t.role)&&F()},[e,w]);let F=async()=>{try{g(!0);let e=await fetch("/api/reports/frequency?period=".concat(w));if(e.ok){let t=await e.json();y(t.frequencyData||[]),v(t.monthlyStats||[])}}catch(e){}finally{g(!1)}},M=[...j].sort((e,t)=>{let s,r;switch(q){case"frequency":default:s=e.frequencyPercentage,r=t.frequencyPercentage;break;case"name":s=e.user.name,r=t.user.name;break;case"hours":s=e.averageHours,r=t.averageHours;break;case"lates":s=e.lateCount,r=t.lateCount}if("string"==typeof s&&"string"==typeof r)return"asc"===C?s.localeCompare(r):r.localeCompare(s);let a="number"==typeof s?s:0,n="number"==typeof r?r:0;return"asc"===C?a-n:n-a}),P=e=>e>=95?"text-success":e>=85?"text-warning":"text-error",S=e=>e>=95?{text:"Excelente",color:"bg-success/20 text-success"}:e>=85?{text:"Bom",color:"bg-warning/20 text-warning"}:e>=70?{text:"Regular",color:"bg-orange-500/20 text-orange-400"}:{text:"Baixo",color:"bg-error/20 text-error"},E=e=>{switch(e){case"ADMIN":return"text-red-400";case"SUPERVISOR":return"text-yellow-400";case"EMPLOYEE":return"text-blue-400";default:return"text-neutral-400"}},U={totalUsers:j.length,averageFrequency:j.length>0?j.reduce((e,t)=>e+t.frequencyPercentage,0)/j.length:0,excellentUsers:j.filter(e=>e.frequencyPercentage>=95).length,lowFrequencyUsers:j.filter(e=>e.frequencyPercentage<70).length};return"loading"===t||b?(0,r.jsx)(p.gb,{}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-900",children:[(0,r.jsx)("div",{className:"bg-neutral-800/50 border-b border-neutral-700",children:(0,r.jsx)("div",{className:"container mx-auto px-6 py-4",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(f.z,{asChild:!0,variant:"ghost",size:"sm",children:(0,r.jsxs)(c.default,{href:"/admin/reports",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),"Voltar aos Relat\xf3rios"]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"An\xe1lise de Frequ\xeancia"}),(0,r.jsx)("p",{className:"text-neutral-400",children:"Relat\xf3rio detalhado de presen\xe7a e pontualidade"})]})]})})})}),(0,r.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,r.jsx)(h.Zb,{className:"mb-6",children:(0,r.jsx)(h.aY,{className:"p-6",children:(0,r.jsx)("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Per\xedodo"}),(0,r.jsxs)("select",{className:"input",value:w,onChange:e=>k(e.target.value),children:[(0,r.jsx)("option",{value:"7",children:"\xdaltimos 7 dias"}),(0,r.jsx)("option",{value:"30",children:"\xdaltimos 30 dias"}),(0,r.jsx)("option",{value:"90",children:"\xdaltimos 90 dias"}),(0,r.jsx)("option",{value:"365",children:"\xdaltimo ano"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Ordenar por"}),(0,r.jsxs)("select",{className:"input",value:q,onChange:e=>Z(e.target.value),children:[(0,r.jsx)("option",{value:"frequency",children:"Frequ\xeancia"}),(0,r.jsx)("option",{value:"name",children:"Nome"}),(0,r.jsx)("option",{value:"hours",children:"Horas M\xe9dias"}),(0,r.jsx)("option",{value:"lates",children:"Atrasos"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Ordem"}),(0,r.jsxs)("select",{className:"input",value:C,onChange:e=>R(e.target.value),children:[(0,r.jsx)("option",{value:"desc",children:"Decrescente"}),(0,r.jsx)("option",{value:"asc",children:"Crescente"})]})]})]})})})}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[(0,r.jsx)(h.Zb,{children:(0,r.jsx)(h.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-neutral-400",children:"Total de Usu\xe1rios"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:U.totalUsers})]}),(0,r.jsx)(d.Z,{className:"h-8 w-8 text-primary"})]})})}),(0,r.jsx)(h.Zb,{children:(0,r.jsx)(h.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-neutral-400",children:"Frequ\xeancia M\xe9dia"}),(0,r.jsxs)("p",{className:"text-2xl font-bold ".concat(P(U.averageFrequency)),children:[U.averageFrequency.toFixed(1),"%"]})]}),(0,r.jsx)(x.Z,{className:"h-8 w-8 text-primary"})]})})}),(0,r.jsx)(h.Zb,{children:(0,r.jsx)(h.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-neutral-400",children:"Excelente (≥95%)"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-success",children:U.excellentUsers})]}),(0,r.jsx)(u,{className:"h-8 w-8 text-success"})]})})}),(0,r.jsx)(h.Zb,{children:(0,r.jsx)(h.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-neutral-400",children:"Baixa Frequ\xeancia (<70%)"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-error",children:U.lowFrequencyUsers})]}),(0,r.jsx)(o.Z,{className:"h-8 w-8 text-error"})]})})})]}),N.length>0&&(0,r.jsxs)(h.Zb,{className:"mb-6",children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Tend\xeancia Mensal"})}),(0,r.jsx)(h.aY,{children:(0,r.jsx)("div",{className:"space-y-4",children:N.map((e,t)=>(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:e.month}),(0,r.jsxs)("span",{className:"text-sm text-neutral-400",children:[e.averageFrequency.toFixed(1),"% • ",e.totalRecords," registros"]})]}),(0,r.jsx)("div",{className:"w-full bg-neutral-700 rounded-full h-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full ".concat(e.averageFrequency>=95?"bg-success":e.averageFrequency>=85?"bg-warning":"bg-error"),style:{width:"".concat(Math.min(e.averageFrequency,100),"%")}})})]})},t))})})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{children:"Frequ\xeancia por Usu\xe1rio"})}),(0,r.jsx)(h.aY,{children:M.length>0?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-neutral-700",children:[(0,r.jsx)("th",{className:"text-left py-3 px-4 text-neutral-300 font-medium",children:"Usu\xe1rio"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-neutral-300 font-medium",children:"Role"}),(0,r.jsx)("th",{className:"text-center py-3 px-4 text-neutral-300 font-medium",children:"Frequ\xeancia"}),(0,r.jsx)("th",{className:"text-center py-3 px-4 text-neutral-300 font-medium",children:"Dias Presentes"}),(0,r.jsx)("th",{className:"text-center py-3 px-4 text-neutral-300 font-medium",children:"Faltas"}),(0,r.jsx)("th",{className:"text-center py-3 px-4 text-neutral-300 font-medium",children:"Atrasos"}),(0,r.jsx)("th",{className:"text-center py-3 px-4 text-neutral-300 font-medium",children:"Horas M\xe9dias"}),(0,r.jsx)("th",{className:"text-center py-3 px-4 text-neutral-300 font-medium",children:"Status"})]})}),(0,r.jsx)("tbody",{children:M.map(e=>{let t=S(e.frequencyPercentage);return(0,r.jsxs)("tr",{className:"border-b border-neutral-800 hover:bg-neutral-800/30",children:[(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:e.user.name}),(0,r.jsx)("p",{className:"text-neutral-400 text-sm",children:e.user.email})]})}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("span",{className:"text-sm font-medium ".concat(E(e.user.role)),children:e.user.role})}),(0,r.jsx)("td",{className:"py-3 px-4 text-center",children:(0,r.jsxs)("span",{className:"text-lg font-bold ".concat(P(e.frequencyPercentage)),children:[e.frequencyPercentage.toFixed(1),"%"]})}),(0,r.jsxs)("td",{className:"py-3 px-4 text-center text-white",children:[e.presentDays,"/",e.totalDays]}),(0,r.jsx)("td",{className:"py-3 px-4 text-center",children:(0,r.jsx)("span",{className:e.absentDays>0?"text-error":"text-neutral-400",children:e.absentDays})}),(0,r.jsx)("td",{className:"py-3 px-4 text-center",children:(0,r.jsx)("span",{className:e.lateCount>0?"text-warning":"text-neutral-400",children:e.lateCount})}),(0,r.jsxs)("td",{className:"py-3 px-4 text-center text-white",children:[e.averageHours.toFixed(1),"h"]}),(0,r.jsx)("td",{className:"py-3 px-4 text-center",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(t.color),children:t.text})})]},e.user.id)})})]})}):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(m.Z,{className:"h-12 w-12 text-neutral-500 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"Nenhum dado de frequ\xeancia encontrado"}),(0,r.jsx)("p",{className:"text-neutral-400",children:"N\xe3o h\xe1 registros suficientes para o per\xedodo selecionado"})]})})]})]})]}):null}},4226:function(e,t,s){"use strict";s.d(t,{z:function(){return l}});var r=s(7437),a=s(2265),n=s(4508);let l=a.forwardRef((e,t)=>{let{className:s,variant:l="primary",size:c="md",loading:i=!1,asChild:d=!1,children:x,disabled:u,...o}=e,m=(0,n.cn)("btn",{primary:"btn-primary",secondary:"btn-secondary",ghost:"btn-ghost",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90"}[l],{sm:"btn-sm",md:"btn-md",lg:"btn-lg"}[c],i&&"opacity-50 cursor-not-allowed",s);if(d){var h;return a.cloneElement(x,{className:(0,n.cn)(m,null===(h=x.props)||void 0===h?void 0:h.className),...o})}return(0,r.jsxs)("button",{className:m,ref:t,disabled:u||i,...o,children:[i&&(0,r.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),x]})});l.displayName="Button"},9178:function(e,t,s){"use strict";s.d(t,{Ol:function(){return c},Zb:function(){return l},aY:function(){return d},ll:function(){return i}});var r=s(7437),a=s(2265),n=s(4508);let l=a.forwardRef((e,t)=>{let{className:s,variant:a="default",children:l,...c}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)({default:"card",glass:"card glass",elevated:"card shadow-xl hover:shadow-2xl transition-shadow duration-300"}[a],s),...c,children:l})});l.displayName="Card";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});c.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",s),...a})});i.displayName="CardTitle",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})}).displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},3214:function(e,t,s){"use strict";s.d(t,{gb:function(){return n}});var r=s(7437);s(2265);var a=s(4508);function n(e){let{size:t="md",className:s,text:n}=e;return(0,r.jsxs)("div",{className:(0,a.cn)("flex flex-col items-center justify-center space-y-2",s),children:[(0,r.jsx)("div",{className:(0,a.cn)("animate-spin rounded-full border-2 border-primary border-t-transparent",{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t])}),n&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground animate-pulse",children:n})]})}},4508:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(1994),a=s(3335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}},3639:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6221:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},5805:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[554,605,981,971,117,744],function(){return e(e.s=5628)}),_N_E=e.O()}]);