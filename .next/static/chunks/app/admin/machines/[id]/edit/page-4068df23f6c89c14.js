(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[505],{1803:function(e,a,t){Promise.resolve().then(t.bind(t,4078))},4078:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return p}});var s=t(7437),r=t(605),n=t(9376),l=t(2265),i=t(7648),c=t(2660),d=t(9897),o=t(3774),u=t(8728),m=t(3229),x=t(9178),h=t(4226),f=t(3214);function p(e){let{params:a}=e,{data:t,status:p}=(0,r.useSession)(),v=(0,n.useRouter)(),[j,N]=(0,l.useState)(null),[b,y]=(0,l.useState)({}),[g,w]=(0,l.useState)(!0),[k,A]=(0,l.useState)(!1),[R,S]=(0,l.useState)({});(0,l.useEffect)(()=>{"loading"===p||t||(0,r.signIn)()},[p]),(0,l.useEffect)(()=>{var e;t&&!["ADMIN","SUPERVISOR"].includes(null===(e=t.user)||void 0===e?void 0:e.role)&&v.push("/employee")},[t]),(0,l.useEffect)(()=>{var e;t&&["ADMIN","SUPERVISOR"].includes(null===(e=t.user)||void 0===e?void 0:e.role)&&C()},[t,a.id]);let C=async()=>{try{w(!0);let e=await fetch("/api/machines/".concat(a.id));if(e.ok){let a=await e.json();N(a),y({name:a.name,location:a.location,isActive:a.isActive})}else v.push("/admin/machines")}catch(e){v.push("/admin/machines")}finally{w(!1)}},Z=()=>{let e={};return b.name&&b.name.length<3&&(e.name="Nome deve ter pelo menos 3 caracteres"),b.location&&b.location.length<5&&(e.location="Localiza\xe7\xe3o deve ter pelo menos 5 caracteres"),S(e),0===Object.keys(e).length},z=async e=>{if(e.preventDefault(),Z())try{A(!0);let e={};b.name!==(null==j?void 0:j.name)&&(e.name=b.name),b.location!==(null==j?void 0:j.location)&&(e.location=b.location),b.isActive!==(null==j?void 0:j.isActive)&&(e.isActive=b.isActive);let t=await fetch("/api/machines/".concat(a.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)v.push("/admin/machines");else{let e=await t.json();S({general:e.error||"Erro ao atualizar m\xe1quina"})}}catch(e){S({general:"Erro interno. Tente novamente."})}finally{A(!1)}};return"loading"===p||g?(0,s.jsx)(f.gb,{}):t&&j?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-900",children:[(0,s.jsx)("div",{className:"bg-neutral-800/50 border-b border-neutral-700",children:(0,s.jsx)("div",{className:"container mx-auto px-6 py-4",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(h.z,{asChild:!0,variant:"ghost",size:"sm",children:(0,s.jsxs)(i.default,{href:"/admin/machines",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Voltar \xe0s M\xe1quinas"]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Editar M\xe1quina"}),(0,s.jsxs)("p",{className:"text-neutral-400",children:["Atualizar configura\xe7\xf5es de ",j.name]})]})]})})})}),(0,s.jsx)("div",{className:"container mx-auto px-6 py-8",children:(0,s.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,s.jsxs)(x.Zb,{children:[(0,s.jsx)(x.Ol,{children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-primary/20 rounded-full flex items-center justify-center",children:(0,s.jsx)(d.Z,{className:"h-6 w-6 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(x.ll,{children:"Atualizar Configura\xe7\xf5es"}),(0,s.jsx)("p",{className:"text-neutral-400 text-sm",children:"Modifique as informa\xe7\xf5es da m\xe1quina"})]})]})}),(0,s.jsx)(x.aY,{children:(0,s.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[R.general&&(0,s.jsx)("div",{className:"p-4 bg-error/20 border border-error/50 rounded-lg text-error text-sm",children:R.general}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Informa\xe7\xf5es da M\xe1quina"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Nome da M\xe1quina"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Ex: Terminal Principal, Kiosk Recep\xe7\xe3o...",className:"input pl-10 ".concat(R.name?"border-error":""),value:b.name||"",onChange:e=>y(a=>({...a,name:e.target.value}))})]}),R.name&&(0,s.jsx)("p",{className:"text-error text-xs mt-1",children:R.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Localiza\xe7\xe3o"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(o.Z,{className:"absolute left-3 top-3 h-4 w-4 text-neutral-400"}),(0,s.jsx)("textarea",{placeholder:"Ex: Recep\xe7\xe3o - T\xe9rreo, Sala de Reuni\xf5es - 2\xba Andar...",className:"input pl-10 min-h-[80px] resize-none ".concat(R.location?"border-error":""),value:b.location||"",onChange:e=>y(a=>({...a,location:e.target.value}))})]}),R.location&&(0,s.jsx)("p",{className:"text-error text-xs mt-1",children:R.location})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-3",children:"Status da M\xe1quina"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"radio",name:"isActive",checked:!0===b.isActive,onChange:()=>y(e=>({...e,isActive:!0})),className:"w-4 h-4 text-primary bg-neutral-700 border-neutral-600 focus:ring-primary"}),(0,s.jsx)("span",{className:"text-success text-sm",children:"Ativa"})]}),(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"radio",name:"isActive",checked:!1===b.isActive,onChange:()=>y(e=>({...e,isActive:!1})),className:"w-4 h-4 text-primary bg-neutral-700 border-neutral-600 focus:ring-primary"}),(0,s.jsx)("span",{className:"text-neutral-500 text-sm",children:"Inativa"})]})]}),(0,s.jsx)("p",{className:"text-neutral-500 text-xs mt-1",children:"M\xe1quinas inativas n\xe3o podem gerar QR codes"})]})]}),j._count&&(0,s.jsx)("div",{className:"bg-neutral-800/30 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)(u.Z,{className:"h-5 w-5 text-neutral-400 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-white mb-2",children:"Estat\xedsticas da M\xe1quina"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-xs text-neutral-400",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"block text-neutral-300",children:"Registros de Ponto:"}),(0,s.jsx)("span",{className:"text-white font-medium",children:j._count.attendanceRecords||0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"block text-neutral-300",children:"QR Codes Gerados:"}),(0,s.jsx)("span",{className:"text-white font-medium",children:j._count.qrEvents||0})]})]}),(0,s.jsxs)("p",{className:"text-xs text-neutral-500 mt-2",children:["Criada em: ",new Date(j.createdAt).toLocaleDateString("pt-BR")]})]})]})}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-neutral-700",children:[(0,s.jsx)(h.z,{asChild:!0,variant:"ghost",children:(0,s.jsx)(i.default,{href:"/admin/machines",children:"Cancelar"})}),(0,s.jsx)(h.z,{type:"submit",disabled:k,className:"min-w-[150px]",children:k?(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{children:"Salvando..."})]}):(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Salvar Altera\xe7\xf5es"})]})})]})]})})]})})})]}):null}},4226:function(e,a,t){"use strict";t.d(a,{z:function(){return l}});var s=t(7437),r=t(2265),n=t(4508);let l=r.forwardRef((e,a)=>{let{className:t,variant:l="primary",size:i="md",loading:c=!1,asChild:d=!1,children:o,disabled:u,...m}=e,x=(0,n.cn)("btn",{primary:"btn-primary",secondary:"btn-secondary",ghost:"btn-ghost",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90"}[l],{sm:"btn-sm",md:"btn-md",lg:"btn-lg"}[i],c&&"opacity-50 cursor-not-allowed",t);if(d){var h;return r.cloneElement(o,{className:(0,n.cn)(x,null===(h=o.props)||void 0===h?void 0:h.className),...m})}return(0,s.jsxs)("button",{className:x,ref:a,disabled:u||c,...m,children:[c&&(0,s.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),o]})});l.displayName="Button"},9178:function(e,a,t){"use strict";t.d(a,{Ol:function(){return i},Zb:function(){return l},aY:function(){return d},ll:function(){return c}});var s=t(7437),r=t(2265),n=t(4508);let l=r.forwardRef((e,a)=>{let{className:t,variant:r="default",children:l,...i}=e;return(0,s.jsx)("div",{ref:a,className:(0,n.cn)({default:"card",glass:"card glass",elevated:"card shadow-xl hover:shadow-2xl transition-shadow duration-300"}[r],t),...i,children:l})});l.displayName="Card";let i=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("h3",{ref:a,className:(0,n.cn)("font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("p",{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})}).displayName="CardDescription";let d=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,n.cn)("p-6 pt-0",t),...r})});d.displayName="CardContent",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,n.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},3214:function(e,a,t){"use strict";t.d(a,{gb:function(){return n}});var s=t(7437);t(2265);var r=t(4508);function n(e){let{size:a="md",className:t,text:n}=e;return(0,s.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center justify-center space-y-2",t),children:[(0,s.jsx)("div",{className:(0,r.cn)("animate-spin rounded-full border-2 border-primary border-t-transparent",{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[a])}),n&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground animate-pulse",children:n})]})}},4508:function(e,a,t){"use strict";t.d(a,{cn:function(){return n}});var s=t(1994),r=t(3335);function n(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,r.m6)((0,s.W)(a))}},2660:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3774:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},9897:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9763).Z)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]])},3229:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},8728:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9376:function(e,a,t){"use strict";var s=t(5475);t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(a,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[554,605,981,971,117,744],function(){return e(e.s=1803)}),_N_E=e.O()}]);