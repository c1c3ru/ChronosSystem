(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{9325:function(e,s,a){Promise.resolve().then(a.bind(a,2432))},2432:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return k}});var t=a(7437),r=a(605),l=a(9376),i=a(2265),n=a(2660),c=a(8906),d=a(4226),o=a(9178),x=a(9763);let u=(0,x.Z)("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),m=(0,x.Z)("ShieldX",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m14.5 9-5 5",key:"1m49dw"}],["path",{d:"m9.5 9 5 5",key:"wyx7zg"}]]),h=(0,x.Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);var f=a(7769),j=a(2208);let p=(0,x.Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var g=a(4508);let N=i.forwardRef((e,s)=>{let{className:a,type:r,error:l,helperText:i,...n}=e;return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("input",{type:r,className:(0,g.cn)("input",l&&"border-destructive focus-visible:ring-destructive",a),ref:s,...n}),i&&(0,t.jsx)("p",{className:(0,g.cn)("mt-1 text-xs",l?"text-destructive":"text-muted-foreground"),children:i})]})});N.displayName="Input";let v=i.forwardRef((e,s)=>{let{className:a,variant:r="default",...l}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:(0,g.cn)("relative w-full rounded-lg border p-4",{default:"bg-slate-100 text-slate-900 border-slate-200",destructive:"bg-red-50 text-red-900 border-red-200",warning:"bg-yellow-50 text-yellow-900 border-yellow-200",success:"bg-green-50 text-green-900 border-green-200"}[r],a),...l})});v.displayName="Alert";let y=i.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("text-sm [&_p]:leading-relaxed",a),...r})});function b(){let[e,s]=(0,i.useState)(null),[a,r]=(0,i.useState)(null),[l,n]=(0,i.useState)(""),[x,g]=(0,i.useState)(!1),[b,w]=(0,i.useState)(""),[k,C]=(0,i.useState)(""),[S,Z]=(0,i.useState)(!1),[z,A]=(0,i.useState)("status");(0,i.useEffect)(()=>{E()},[]);let E=async()=>{try{let e=await fetch("/api/auth/2fa/setup"),a=await e.json();e.ok?s(a):w(a.error||"Erro ao carregar status")}catch(e){w("Erro de conex\xe3o")}},O=async()=>{g(!0),w("");try{let e=await fetch("/api/auth/2fa/setup",{method:"POST"}),s=await e.json();e.ok?(r(s.setup),A("setup")):w(s.error||"Erro ao configurar 2FA")}catch(e){w("Erro de conex\xe3o")}finally{g(!1)}},R=async()=>{if(!l||6!==l.length){w("Digite um c\xf3digo de 6 d\xedgitos");return}g(!0),w("");try{let e=await fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:l})}),s=await e.json();e.ok?(C(s.message),A("status"),n(""),r(null),await E()):w(s.error||"Token inv\xe1lido")}catch(e){w("Erro de conex\xe3o")}finally{g(!1)}},M=async()=>{if(!l||6!==l.length){w("Digite um c\xf3digo de 6 d\xedgitos para confirmar");return}g(!0),w("");try{let e=await fetch("/api/auth/2fa/disable",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:l})}),s=await e.json();e.ok?(C(s.message),n(""),await E()):w(s.error||"Erro ao desabilitar 2FA")}catch(e){w("Erro de conex\xe3o")}finally{g(!1)}};return e?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(o.Zb,{children:[(0,t.jsx)(o.Ol,{children:(0,t.jsxs)(o.ll,{className:"flex items-center space-x-2",children:[e.enabled?(0,t.jsx)(u,{className:"w-5 h-5 text-green-500"}):(0,t.jsx)(m,{className:"w-5 h-5 text-red-500"}),(0,t.jsx)("span",{children:"Autentica\xe7\xe3o de Dois Fatores (2FA)"})]})}),(0,t.jsxs)(o.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium",children:["Status: ",e.enabled?"Habilitado":"Desabilitado"]}),(0,t.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:e.enabled?"Sua conta est\xe1 protegida com 2FA":"Adicione uma camada extra de seguran\xe7a"})]}),(0,t.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.enabled?"bg-green-500":"bg-red-500")})]}),!e.enabled&&(0,t.jsxs)(d.z,{onClick:O,disabled:x,className:"w-full",children:[(0,t.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"Configurar 2FA"]}),e.enabled&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)(v,{children:[(0,t.jsx)(h,{className:"w-4 h-4"}),(0,t.jsx)(y,{children:"2FA est\xe1 ativo. Use seu app autenticador para gerar c\xf3digos de acesso."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"C\xf3digo do app autenticador (para desabilitar):"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(N,{type:"text",placeholder:"000000",value:l,onChange:e=>n(e.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"text-center text-lg tracking-widest"}),(0,t.jsx)(d.z,{onClick:M,disabled:x||6!==l.length,variant:"destructive",children:"Desabilitar"})]})]})]})]})]}),"setup"===z&&a&&(0,t.jsxs)(o.Zb,{children:[(0,t.jsx)(o.Ol,{children:(0,t.jsx)(o.ll,{children:"Configurar Autenticador"})}),(0,t.jsxs)(o.aY,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"font-medium",children:"Instru\xe7\xf5es:"}),(0,t.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-slate-600 dark:text-slate-400",children:[(0,t.jsx)("li",{children:a.instructions.step1}),(0,t.jsx)("li",{children:a.instructions.step2}),(0,t.jsx)("li",{children:a.instructions.step3})]})]}),(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"inline-block p-4 bg-white rounded-lg",children:(0,t.jsx)("img",{src:a.qrCodeUrl,alt:"QR Code para 2FA",className:"w-48 h-48"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(d.z,{variant:"secondary",size:"sm",onClick:()=>Z(!S),children:[S?(0,t.jsx)(f.Z,{className:"w-4 h-4 mr-2"}):(0,t.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),S?"Ocultar":"Mostrar"," chave manual"]}),S&&(0,t.jsx)("div",{className:"p-3 bg-slate-100 dark:bg-slate-800 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("code",{className:"text-sm font-mono break-all",children:a.manualEntryKey}),(0,t.jsx)(d.z,{size:"sm",variant:"ghost",onClick:()=>{(null==a?void 0:a.manualEntryKey)&&(navigator.clipboard.writeText(a.manualEntryKey),C("Chave copiada para a \xe1rea de transfer\xeancia!"))},children:(0,t.jsx)(p,{className:"w-4 h-4"})})]})})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Digite o c\xf3digo de 6 d\xedgitos do seu app:"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(N,{type:"text",placeholder:"000000",value:l,onChange:e=>n(e.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"text-center text-lg tracking-widest"}),(0,t.jsx)(d.z,{onClick:R,disabled:x||6!==l.length,children:"Verificar"})]})]}),(0,t.jsx)(d.z,{variant:"secondary",onClick:()=>A("status"),className:"w-full",children:"Cancelar"})]})]}),b&&(0,t.jsx)(v,{variant:"destructive",children:(0,t.jsx)(y,{children:b})}),k&&(0,t.jsx)(v,{children:(0,t.jsx)(y,{className:"text-green-600",children:k})})]}):(0,t.jsx)(o.Zb,{children:(0,t.jsx)(o.aY,{className:"p-6",children:(0,t.jsx)("div",{className:"text-center",children:"Carregando..."})})})}y.displayName="AlertDescription";var w=a(7648);function k(){let{data:e,status:s}=(0,r.useSession)(),a=(0,l.useRouter)();return((0,i.useEffect)(()=>{var t;if("loading"!==s){if(!e){a.push("/auth/signin");return}if(!["ADMIN","SUPERVISOR"].includes(null===(t=e.user)||void 0===t?void 0:t.role)){a.push("/employee");return}}},[e,s,a]),"loading"===s)?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-white",children:"Carregando..."})}):e?(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[(0,t.jsx)("div",{className:"bg-slate-800/50 backdrop-blur-sm border-b border-slate-700/50",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(w.default,{href:"/admin",children:(0,t.jsxs)(d.z,{variant:"ghost",size:"sm",children:[(0,t.jsx)(n.Z,{className:"w-4 h-4 mr-2"}),"Voltar"]})}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center",children:(0,t.jsx)(c.Z,{className:"w-5 h-5 text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Configura\xe7\xf5es de Seguran\xe7a"}),(0,t.jsx)("p",{className:"text-slate-400",children:"Gerencie a seguran\xe7a da sua conta"})]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-white font-medium",children:e.user.name}),(0,t.jsx)("p",{className:"text-slate-400 text-sm",children:e.user.role})]})]})})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,t.jsxs)(o.Zb,{className:"bg-slate-800/50 border-slate-700/50",children:[(0,t.jsx)(o.Ol,{children:(0,t.jsx)(o.ll,{className:"text-white",children:"Informa\xe7\xf5es da Conta"})}),(0,t.jsx)(o.aY,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-300",children:"Email"}),(0,t.jsx)("p",{className:"text-white",children:e.user.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-300",children:"Fun\xe7\xe3o"}),(0,t.jsx)("p",{className:"text-white",children:e.user.role})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-300",children:"Nome"}),(0,t.jsx)("p",{className:"text-white",children:e.user.name||"N\xe3o informado"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-300",children:"ID do Usu\xe1rio"}),(0,t.jsx)("p",{className:"text-slate-400 font-mono text-sm",children:e.user.id})]})]})})]}),(0,t.jsx)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-6",children:(0,t.jsx)(b,{})}),(0,t.jsxs)(o.Zb,{className:"bg-slate-800/50 border-slate-700/50",children:[(0,t.jsx)(o.Ol,{children:(0,t.jsx)(o.ll,{className:"text-white",children:"Outras Configura\xe7\xf5es"})}),(0,t.jsx)(o.aY,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700/30 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-white",children:"Sess\xf5es Ativas"}),(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Gerencie suas sess\xf5es de login"})]}),(0,t.jsx)(d.z,{variant:"secondary",disabled:!0,children:"Em breve"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700/30 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-white",children:"Logs de Atividade"}),(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Visualize suas atividades recentes"})]}),(0,t.jsx)(w.default,{href:"/admin/audit",children:(0,t.jsx)(d.z,{variant:"secondary",children:"Ver Logs"})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-700/30 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-white",children:"Alterar Senha"}),(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Atualize sua senha de acesso"})]}),(0,t.jsx)(d.z,{variant:"secondary",disabled:!0,children:"Em breve"})]})]})})]}),(0,t.jsxs)(o.Zb,{className:"bg-blue-500/10 border-blue-500/20",children:[(0,t.jsx)(o.Ol,{children:(0,t.jsxs)(o.ll,{className:"text-blue-400 flex items-center",children:[(0,t.jsx)(c.Z,{className:"w-5 h-5 mr-2"}),"Dicas de Seguran\xe7a"]})}),(0,t.jsx)(o.aY,{children:(0,t.jsxs)("ul",{className:"space-y-2 text-sm text-slate-300",children:[(0,t.jsx)("li",{children:"• Use senhas fortes e \xfanicas para cada conta"}),(0,t.jsx)("li",{children:"• Habilite a autentica\xe7\xe3o de dois fatores (2FA) sempre que poss\xedvel"}),(0,t.jsx)("li",{children:"• Mantenha seus aplicativos autenticadores atualizados"}),(0,t.jsx)("li",{children:"• N\xe3o compartilhe seus c\xf3digos 2FA com ningu\xe9m"}),(0,t.jsx)("li",{children:"• Fa\xe7a logout de dispositivos que n\xe3o usa mais"}),(0,t.jsx)("li",{children:"• Monitore regularmente suas atividades de login"})]})})]})]})})]}):null}},4226:function(e,s,a){"use strict";a.d(s,{z:function(){return i}});var t=a(7437),r=a(2265),l=a(4508);let i=r.forwardRef((e,s)=>{let{className:a,variant:i="primary",size:n="md",loading:c=!1,asChild:d=!1,children:o,disabled:x,...u}=e,m=(0,l.cn)("btn",{primary:"btn-primary",secondary:"btn-secondary",ghost:"btn-ghost",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90"}[i],{sm:"btn-sm",md:"btn-md",lg:"btn-lg"}[n],c&&"opacity-50 cursor-not-allowed",a);if(d){var h;return r.cloneElement(o,{className:(0,l.cn)(m,null===(h=o.props)||void 0===h?void 0:h.className),...u})}return(0,t.jsxs)("button",{className:m,ref:s,disabled:x||c,...u,children:[c&&(0,t.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),o]})});i.displayName="Button"},9178:function(e,s,a){"use strict";a.d(s,{Ol:function(){return n},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var t=a(7437),r=a(2265),l=a(4508);let i=r.forwardRef((e,s)=>{let{className:a,variant:r="default",children:i,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)({default:"card",glass:"card glass",elevated:"card shadow-xl hover:shadow-2xl transition-shadow duration-300"}[r],a),...n,children:i})});i.displayName="Card";let n=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});n.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("h3",{ref:s,className:(0,l.cn)("font-semibold leading-none tracking-tight",a),...r})});c.displayName="CardTitle",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("p",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})}).displayName="CardDescription";let d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",a),...r})});d.displayName="CardContent",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},4508:function(e,s,a){"use strict";a.d(s,{cn:function(){return l}});var t=a(1994),r=a(3335);function l(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.m6)((0,t.W)(s))}},2660:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7769:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},2208:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8906:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},9376:function(e,s,a){"use strict";var t=a(5475);a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[554,605,981,971,117,744],function(){return e(e.s=9325)}),_N_E=e.O()}]);