"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var next_auth_middleware__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/middleware */ \"(middleware)/./node_modules/next-auth/middleware.js\");\n/* harmony import */ var next_auth_middleware__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth_middleware__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_auth_middleware__WEBPACK_IMPORTED_MODULE_0__.withAuth)(function middleware(req) {\n    const { pathname } = req.nextUrl;\n    const token = req.nextauth.token;\n    // Rotas que requerem autenticação\n    const protectedRoutes = [\n        \"/admin\",\n        \"/employee\",\n        \"/api/users\",\n        \"/api/machines\",\n        \"/api/attendance\",\n        \"/api/dashboard\"\n    ];\n    // Verificar se a rota atual é protegida\n    const isProtectedRoute = protectedRoutes.some((route)=>pathname.startsWith(route));\n    if (isProtectedRoute && !token) {\n        // Redirecionar para login se não autenticado\n        const signInUrl = new URL(\"/auth/signin\", req.url);\n        signInUrl.searchParams.set(\"callbackUrl\", pathname);\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.redirect(signInUrl);\n    }\n    // Rotas específicas para roles\n    if (pathname.startsWith(\"/admin\")) {\n        if (!token || ![\n            \"ADMIN\",\n            \"SUPERVISOR\"\n        ].includes(token.role)) {\n            // Redirecionar para página do employee se não for admin/supervisor\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.redirect(new URL(\"/employee\", req.url));\n        }\n    }\n    // APIs administrativas\n    if (pathname.startsWith(\"/api/users\") || pathname.startsWith(\"/api/machines\") || pathname.startsWith(\"/api/dashboard\")) {\n        if (!token || ![\n            \"ADMIN\",\n            \"SUPERVISOR\"\n        ].includes(token.role)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: \"N\\xe3o autorizado\"\n            }, {\n                status: 401\n            });\n        }\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.next();\n}, {\n    callbacks: {\n        authorized: ({ token, req })=>{\n            const { pathname } = req.nextUrl;\n            // Permitir acesso às rotas públicas\n            const publicRoutes = [\n                \"/\",\n                \"/auth/signin\",\n                \"/auth/signup\",\n                \"/kiosk\"\n            ];\n            if (publicRoutes.includes(pathname)) {\n                return true;\n            }\n            // Rotas de API públicas\n            if (pathname.startsWith(\"/api/auth\")) {\n                return true;\n            }\n            // Outras rotas requerem token\n            return !!token;\n        }\n    }\n}));\nconst config = {\n    matcher: [\n        /*\n     * Match all request paths except for the ones starting with:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - manifest.json (PWA manifest)\n     * - icon files (PWA icons)\n     * - public folder\n     */ \"/((?!_next/static|_next/image|favicon.ico|manifest.json|icon-.*\\\\.png|.*\\\\.svg|public).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUErQztBQUNMO0FBRTFDLGlFQUFlQSw4REFBUUEsQ0FDckIsU0FBU0UsV0FBV0MsR0FBRztJQUNyQixNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHRCxJQUFJRSxPQUFPO0lBQ2hDLE1BQU1DLFFBQVFILElBQUlJLFFBQVEsQ0FBQ0QsS0FBSztJQUVoQyxrQ0FBa0M7SUFDbEMsTUFBTUUsa0JBQWtCO1FBQUM7UUFBVTtRQUFhO1FBQWM7UUFBaUI7UUFBbUI7S0FBaUI7SUFFbkgsd0NBQXdDO0lBQ3hDLE1BQU1DLG1CQUFtQkQsZ0JBQWdCRSxJQUFJLENBQUNDLENBQUFBLFFBQVNQLFNBQVNRLFVBQVUsQ0FBQ0Q7SUFFM0UsSUFBSUYsb0JBQW9CLENBQUNILE9BQU87UUFDOUIsNkNBQTZDO1FBQzdDLE1BQU1PLFlBQVksSUFBSUMsSUFBSSxnQkFBZ0JYLElBQUlZLEdBQUc7UUFDakRGLFVBQVVHLFlBQVksQ0FBQ0MsR0FBRyxDQUFDLGVBQWViO1FBQzFDLE9BQU9ILHFEQUFZQSxDQUFDaUIsUUFBUSxDQUFDTDtJQUMvQjtJQUVBLCtCQUErQjtJQUMvQixJQUFJVCxTQUFTUSxVQUFVLENBQUMsV0FBVztRQUNqQyxJQUFJLENBQUNOLFNBQVMsQ0FBQztZQUFDO1lBQVM7U0FBYSxDQUFDYSxRQUFRLENBQUNiLE1BQU1jLElBQUksR0FBYTtZQUNyRSxtRUFBbUU7WUFDbkUsT0FBT25CLHFEQUFZQSxDQUFDaUIsUUFBUSxDQUFDLElBQUlKLElBQUksYUFBYVgsSUFBSVksR0FBRztRQUMzRDtJQUNGO0lBRUEsdUJBQXVCO0lBQ3ZCLElBQUlYLFNBQVNRLFVBQVUsQ0FBQyxpQkFDcEJSLFNBQVNRLFVBQVUsQ0FBQyxvQkFDcEJSLFNBQVNRLFVBQVUsQ0FBQyxtQkFBbUI7UUFDekMsSUFBSSxDQUFDTixTQUFTLENBQUM7WUFBQztZQUFTO1NBQWEsQ0FBQ2EsUUFBUSxDQUFDYixNQUFNYyxJQUFJLEdBQWE7WUFDckUsT0FBT25CLHFEQUFZQSxDQUFDb0IsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQWlCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUN0RTtJQUNGO0lBRUEsT0FBT3RCLHFEQUFZQSxDQUFDdUIsSUFBSTtBQUMxQixHQUNBO0lBQ0VDLFdBQVc7UUFDVEMsWUFBWSxDQUFDLEVBQUVwQixLQUFLLEVBQUVILEdBQUcsRUFBRTtZQUN6QixNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHRCxJQUFJRSxPQUFPO1lBRWhDLG9DQUFvQztZQUNwQyxNQUFNc0IsZUFBZTtnQkFBQztnQkFBSztnQkFBZ0I7Z0JBQWdCO2FBQVM7WUFDcEUsSUFBSUEsYUFBYVIsUUFBUSxDQUFDZixXQUFXO2dCQUNuQyxPQUFPO1lBQ1Q7WUFFQSx3QkFBd0I7WUFDeEIsSUFBSUEsU0FBU1EsVUFBVSxDQUFDLGNBQWM7Z0JBQ3BDLE9BQU87WUFDVDtZQUVBLDhCQUE4QjtZQUM5QixPQUFPLENBQUMsQ0FBQ047UUFDWDtJQUNGO0FBQ0YsSUFDRDtBQUVNLE1BQU1zQixTQUFTO0lBQ3BCQyxTQUFTO1FBQ1A7Ozs7Ozs7O0tBUUMsR0FDRDtLQUNEO0FBQ0gsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9taWRkbGV3YXJlLnRzPzQyMmQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgd2l0aEF1dGggfSBmcm9tICduZXh0LWF1dGgvbWlkZGxld2FyZSdcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuXG5leHBvcnQgZGVmYXVsdCB3aXRoQXV0aChcbiAgZnVuY3Rpb24gbWlkZGxld2FyZShyZXEpIHtcbiAgICBjb25zdCB7IHBhdGhuYW1lIH0gPSByZXEubmV4dFVybFxuICAgIGNvbnN0IHRva2VuID0gcmVxLm5leHRhdXRoLnRva2VuXG5cbiAgICAvLyBSb3RhcyBxdWUgcmVxdWVyZW0gYXV0ZW50aWNhw6fDo29cbiAgICBjb25zdCBwcm90ZWN0ZWRSb3V0ZXMgPSBbJy9hZG1pbicsICcvZW1wbG95ZWUnLCAnL2FwaS91c2VycycsICcvYXBpL21hY2hpbmVzJywgJy9hcGkvYXR0ZW5kYW5jZScsICcvYXBpL2Rhc2hib2FyZCddXG4gICAgXG4gICAgLy8gVmVyaWZpY2FyIHNlIGEgcm90YSBhdHVhbCDDqSBwcm90ZWdpZGFcbiAgICBjb25zdCBpc1Byb3RlY3RlZFJvdXRlID0gcHJvdGVjdGVkUm91dGVzLnNvbWUocm91dGUgPT4gcGF0aG5hbWUuc3RhcnRzV2l0aChyb3V0ZSkpXG4gICAgXG4gICAgaWYgKGlzUHJvdGVjdGVkUm91dGUgJiYgIXRva2VuKSB7XG4gICAgICAvLyBSZWRpcmVjaW9uYXIgcGFyYSBsb2dpbiBzZSBuw6NvIGF1dGVudGljYWRvXG4gICAgICBjb25zdCBzaWduSW5VcmwgPSBuZXcgVVJMKCcvYXV0aC9zaWduaW4nLCByZXEudXJsKVxuICAgICAgc2lnbkluVXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2NhbGxiYWNrVXJsJywgcGF0aG5hbWUpXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KHNpZ25JblVybClcbiAgICB9XG5cbiAgICAvLyBSb3RhcyBlc3BlY8OtZmljYXMgcGFyYSByb2xlc1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYWRtaW4nKSkge1xuICAgICAgaWYgKCF0b2tlbiB8fCAhWydBRE1JTicsICdTVVBFUlZJU09SJ10uaW5jbHVkZXModG9rZW4ucm9sZSBhcyBzdHJpbmcpKSB7XG4gICAgICAgIC8vIFJlZGlyZWNpb25hciBwYXJhIHDDoWdpbmEgZG8gZW1wbG95ZWUgc2UgbsOjbyBmb3IgYWRtaW4vc3VwZXJ2aXNvclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9lbXBsb3llZScsIHJlcS51cmwpKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFQSXMgYWRtaW5pc3RyYXRpdmFzXG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvdXNlcnMnKSB8fCBcbiAgICAgICAgcGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9tYWNoaW5lcycpIHx8IFxuICAgICAgICBwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL2Rhc2hib2FyZCcpKSB7XG4gICAgICBpZiAoIXRva2VuIHx8ICFbJ0FETUlOJywgJ1NVUEVSVklTT1InXS5pbmNsdWRlcyh0b2tlbi5yb2xlIGFzIHN0cmluZykpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdOw6NvIGF1dG9yaXphZG8nIH0sIHsgc3RhdHVzOiA0MDEgfSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKVxuICB9LFxuICB7XG4gICAgY2FsbGJhY2tzOiB7XG4gICAgICBhdXRob3JpemVkOiAoeyB0b2tlbiwgcmVxIH0pID0+IHtcbiAgICAgICAgY29uc3QgeyBwYXRobmFtZSB9ID0gcmVxLm5leHRVcmxcbiAgICAgICAgXG4gICAgICAgIC8vIFBlcm1pdGlyIGFjZXNzbyDDoHMgcm90YXMgcMO6YmxpY2FzXG4gICAgICAgIGNvbnN0IHB1YmxpY1JvdXRlcyA9IFsnLycsICcvYXV0aC9zaWduaW4nLCAnL2F1dGgvc2lnbnVwJywgJy9raW9zayddXG4gICAgICAgIGlmIChwdWJsaWNSb3V0ZXMuaW5jbHVkZXMocGF0aG5hbWUpKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJvdGFzIGRlIEFQSSBww7pibGljYXNcbiAgICAgICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvYXV0aCcpKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE91dHJhcyByb3RhcyByZXF1ZXJlbSB0b2tlblxuICAgICAgICByZXR1cm4gISF0b2tlblxuICAgICAgfSxcbiAgICB9LFxuICB9XG4pXG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG1hdGNoZXI6IFtcbiAgICAvKlxuICAgICAqIE1hdGNoIGFsbCByZXF1ZXN0IHBhdGhzIGV4Y2VwdCBmb3IgdGhlIG9uZXMgc3RhcnRpbmcgd2l0aDpcbiAgICAgKiAtIF9uZXh0L3N0YXRpYyAoc3RhdGljIGZpbGVzKVxuICAgICAqIC0gX25leHQvaW1hZ2UgKGltYWdlIG9wdGltaXphdGlvbiBmaWxlcylcbiAgICAgKiAtIGZhdmljb24uaWNvIChmYXZpY29uIGZpbGUpXG4gICAgICogLSBtYW5pZmVzdC5qc29uIChQV0EgbWFuaWZlc3QpXG4gICAgICogLSBpY29uIGZpbGVzIChQV0EgaWNvbnMpXG4gICAgICogLSBwdWJsaWMgZm9sZGVyXG4gICAgICovXG4gICAgJy8oKD8hX25leHQvc3RhdGljfF9uZXh0L2ltYWdlfGZhdmljb24uaWNvfG1hbmlmZXN0Lmpzb258aWNvbi0uKlxcXFwucG5nfC4qXFxcXC5zdmd8cHVibGljKS4qKScsXG4gIF0sXG59XG4iXSwibmFtZXMiOlsid2l0aEF1dGgiLCJOZXh0UmVzcG9uc2UiLCJtaWRkbGV3YXJlIiwicmVxIiwicGF0aG5hbWUiLCJuZXh0VXJsIiwidG9rZW4iLCJuZXh0YXV0aCIsInByb3RlY3RlZFJvdXRlcyIsImlzUHJvdGVjdGVkUm91dGUiLCJzb21lIiwicm91dGUiLCJzdGFydHNXaXRoIiwic2lnbkluVXJsIiwiVVJMIiwidXJsIiwic2VhcmNoUGFyYW1zIiwic2V0IiwicmVkaXJlY3QiLCJpbmNsdWRlcyIsInJvbGUiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJuZXh0IiwiY2FsbGJhY2tzIiwiYXV0aG9yaXplZCIsInB1YmxpY1JvdXRlcyIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});